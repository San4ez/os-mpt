<!DOCTYPE html>
<html>
<head>
	<title>Практическая работа #2</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="720">
	<link rel="stylesheet" href="css/style.css">
    <link href="http://fonts.googleapis.com/css?family=Raleway:700,300" rel="stylesheet"
          type="text/css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/prettify.css">
</head>
<body>


<div class="wrapper">
    <nav>
        <div class="pull-left">
            <h1><a href="/os-mpt"><span>Все материалы</span></a></h1>
        </div>
        <div class="pull-right">
        </div>
    </nav>
    <header>
        <div class="container">
            <h2 class="lone-header">Лабораторная #2 по ОС</h2>
        </div>
    </header>
    <section>
        <div class="container">
            <ul class="docs-nav">
                <li><a href="#init" class="cc-active">Введение</a></li>
                <li><a href="#cmd" class="cc-active">CMD</a></li>
                <li><a href="#syn" class="cc-active">Синтаксис</a></li>
                <li><a href="#task" class="cc-active">Задание</a></li>
                <li><a href="#qwe" class="cc-active">Контрольные вопросы</a></li>
                <li><a href="#src" class="cc-active">Ссылки</a></li>

            </ul>
            <div class="docs-content">
            <h2>Лабораторная работа №2 - Работа со сценарными языками. PowerShell, CMD.
			</h2>

			 <b>Цель работы:</b> Ознакомиться с программированием на сценарном языке в системе Windows. 

			<h3 id="init">Введение</h3>
			<p>По прошлой практической работе вы уже познакомились с работой и определением интерпретатора командной строки, теперь пора расти дальше. В том определении говорилось, что он (интерпретатор) может содержать свой скриптовый ЯП (язык программирования). У вас возникает вопрос (я надеюсь на это), что такое скрипты и чем они отличаются от программ? Главным отличием одного от другого будет в том, что у программы есть обширная оболочка. В зависимости от платформы это может быть как документация, руководство, поддержка нескольких языков, средства установки и удалениями и т.д. </p>

			<p>Скрипт же предназначен для решения конкретной проблемы, именно в этот момент времени. У скрипта не будет дополнительных вышеописанных "обвесов". От скрипта никто не будет ждать, что он будет снабжён документацией и сможет выполняться на нескольких платформах. </p>

			<p>В общих чертах чем программа отличается от скрипта это:</p>
			<ol>
				<li>Сложным алгоритмом (обширной логикой)</li>
				<li>Сопроводительной документаций</li>
				<li>Широкой областью применимости (относительной универсальностью)</li>
				<li>Тщательной проверки параметров и предсказуемым поведением в нестандартных ситуациях</li>
		    </ol>

		    <p>Если же код имеет сложный алгоритм, но не имеет сопроводительной документации (и далее по списку) — то это либо плохая программа, либо плохой скрипт.

			Скрипт — «код», настолько компактный и логичный, что является самодокументированным.
			</p>
			<p>Немного обобщая вышесказанное: в более узком смысле под скриптовым языком может пониматься специализированный язык для расширения возможностей командной оболочки или текстового редактора и средств администрирования операционных систем</p>
			<p>Классификация скриптовых ЯП</p>
			<ol>
				<li>Языки общего назначения</li>
				Языки этой категории имеют куда более широкое применение, чем в качестве просто языков для администрирования системы. На данной категории языков возможна разработка веб-приложений/ресурсов и т.д.
				<ol>
					<li>Lua</li>
					<li>Perl</li>
					<li>PHP</li>
					<li>Ruby</li>
					<li>Python</li>
				</ol>
				<li>Командно-сценарные языки</li>
				Как раз этого типа языков мы и коснёмся и с ними будем работать(в основном коснёмся первых двух-трех). Предназначены как раз для решения различных задач в администрировании ОС.
				<ol>
					<li>Sh (bash, csh, ksh)</li>
					<li>Command.com (CMD)</li>
					<li>PowerShell</li>
					<li>VB Script</li>
				</ol>
			</ol>

			<h3 id="cmd">CMD</h3>
			<p>Собственно работать будем с Cmd.exe — это в свою очередь интерпретатор командной строки (англ. command line interpreter) для операционных систем OS/2, Windows CE и для семейства операционных систем, базирующихся на Windows NT (англ. Windows NT-based). cmd.exe является аналогом COMMAND.COM, которая используется в семействах MS-DOS и Windows 9x.</p>
			<p>Данный интерпритатор умеет в свой набор команд(с ними вы уже частично познакомились в предыдущей практической).</p>
			<p>Именно в этой практической работе вы разберете такой аспект его работы, как написание собственных скриптов под данный интерпритатор. Называются они BAT-файлы(потому что расширение у них .bat) <b> и представляют из себя обычные текстовые файлы внутри которого команды для командной строки записаны в столбик. Аналог bash-скриптов на Unix.</b> </p>
			<p>Для тех, кто не понял вышеописанного намёка, создать bat-файл очень просто, вот алгоритм необходимых действий</p>
			<ol>
				<li>Создать обычный текстовый файл с расширением .txt</li>
				<li>Написать в него в столбик команды для командной строки, например: 
<pre class="prettyprint">
@echo "Hello, World!"
</pre>
				Так же перед командой стоит символ "@", он отключает вывод команд, в последнем пункте когда будете реализовывать даный скриптик, попробуйте сначала написать с этим символом, потом без него и почувствуйте разницу.
				</li>
				<li>Поменять расширение файла на .bat. На этом в принципе все, но есть одно "но", вызывать его будем из консоли путем команды: 
<pre class="prettyprint">
call путь_до_батника
</pre>
				она позволит нам сразу посмотреть результат и может быть выведет ошибки, иначе без паузы в конце батника окно консоли сразу закроется. При открытом окне консоли файл батника (да и любой другой файл тоже) можно "перетащить" в окно консоли тем самым определить путь до файла. </li>
				<li>Попробуйте написать его прямо сейчас.</li>
			</ol>
			<p>
				Так же стоит решить, что такое <b>абсолютный</b> и <b>относительный</b> путь до файла. <b>Полный или абсолютный путь </b> — это путь, который указывает на одно и то же место в файловой системе, вне зависимости от текущей рабочей директории или других обстоятельств. Полный путь всегда начинается с корневого каталога. <b>Относительный путь</b> представляет собой путь по отношению к <b>текущему</b> рабочему каталогу пользователя или активных приложений.
			</p>

			<h3 id="syn">Синтаксис</h3>
			<p>Перед разбором синтаксиса хочется сказать, что данный командный язык немного "дубовый", будьте готовы к тому, что лишний пробел перед знаком равенства (=) может породить ошибку, да и вообще с пробелами аккуратней, так же у языка нету типов данных, есть только команды, так же есть некоторые особенности в работе процедур,<b> но это не значит, что он плохой, с помощью него можно сделать множество <s>прекрасных</s> вещей. </b></p>
			<p><b>Переменные</b></p>
			<p>Начнём с переменных. Собственно в разных ЯП переменные объявляются по разному (<s>Ну плюс минус на самом деле</s>), где то после слова var с указанием типа(как в object pascal <s>Delphi</s>), или в любом участке кода как в Си. В bat файлах же переменные объявляются вот такой директивой: </p>
<pre class="prettyprint">
set Var1=D:\Work
set Var2=100
set Var3="Привет Мир!!!"
</pre>
			<p>Так же нельзя объявить группу переменных cmd (как например в Си"), или же сразу присвоить значения нескольким переменным в командной строке. Так же имейте в виду, что Var и VAR3 и vAr3 - это одна и та же переменная, которая выведет hello world.</p>
			<p>Так же стоит учитывать, что </p>
<pre class="prettyprint">
set var1=100
</pre>
			<p>И</p>
<pre class="prettyprint">
set var1 = 100
</pre>
			<p>Это чутка разные вещи, в первом случае мы создаем cmd переменную "var1", а во втором – "var1 ". С присвоением значений аналогичная ситуация, так что обращайте внимание на пробел!</p>
			<p>Вывести переменные можно при помощи echo</p>
<pre class="prettyprint">
echo %Var1%
echo %Var1%
echo %Var1%
</pre>
			<p>Если требуется очистить переменную, то можно присвоить простое пусто значение</p>
<pre class="prettyprint">
set Var3=
</pre>

			<p>Так же можно вывести переменные с помощью set, требуется просто указать её имя</p>
<pre class="prettyprint">
set Var1
set Var2
set Var3
</pre>
			<p>Разницы в выводе не будет, только имейте в виду, что при таком выводе переменные преобразуются в строки </p>
			<p>Так же если задача будет требовать от вас, чтобы переменная содержала какие-нибудь специальные символы их требуется экранировать, в Си например используются управляющие последовательности (например \n, \t, \"), то у нас тут будет использоваться вот такой символ: ^</p>
<pre class="prettyprint">
set Var4=100 ^& 3 = 5
set Var5=100 ^^3
</pre>
			<p>В вывод будет: </p>
<pre class="prettyprint">
"100 & 3 = 5"
"100 ^3"
</pre>		
			<p>ну это при условии, что мы выводим через <b>set</b>, чтобы вывести черз <b>echo</b> нужно сделать следующее: </p>
<pre class="prettyprint">
set Var4=100 ^^^& 3 = 5
set Var5=100 ^^^^3
</pre>	
			То есть просто прописать символ "^" экранирования не один раз, а трижды
			<p>Так же, осталась ещё важная часть о переменных в ОС, существуют специальные переменные, зарезервированные системой для хранения какой либо информации в текстовом виде, называются они <b>Переменные окружения </b>(или переменные среды или англ. environment variable ). Переменные среды задаются в реестре Windows и программным обеспечением. Они могут использоваться в командной строке и в адресной строке проводника. Помимо Windows они там же есть и в Unix, и используются для тех же целей. </p>
			<p>Например: </p>
			<ol>
				<li>DATE - Возвращает текущую дату. Использует тот же формат, что и команда date /t. Создаётся командой Cmd.exe.
				</li>
				<li>HOMEPATH - Возвращает полный путь к основному каталогу пользователя. Задаётся на основании расположения основного каталога. Основной каталог пользователя указывается в оснастке «Локальные пользователи и группы».
				</li>
				<li>PATH - Указывает путь поиска исполняемых файлов.
				</li>
				<li>USERNAME - Имя текущего пользователя.
				</li>
			</ol>
			<p>Я надеюсь вы догадались, что если прозвучало слово "переменные", то логично предположить, что с ними можно работать так же как с обычными переменными, например такая важная переменная как <b>PATH</b>, она указывает путь поиска исполняемых файло, то есть когда вы из консоли запускаете какое нибудь приложение, сначала ОС его ищет в этой переменной, то есть туда можно прописывать различный софт, и ос будет его запускать из консоли, в общих чертах так. Кстати, в Linux то же есть такая же переменная, которая работает по такому же принципу. И работать с этими переменными можно не только из консоли но и при помощи API системы, когда вы разрабатываете прикладные программы.
			Полный список переменных найдёте сами :)</p>

			<p>Так же можно обрабатывать параметры bat-файла (которые можно указывать при его запуске), например вызов файла выглядит вот так: </p>

<pre class="prettyprint">
call param.bat papka
</pre>
			<p>То есть file.txt будет дополнительным параметром при вызове батника, таких параметром может быть сколько угодно, но если их больше 10, то они будет обрабатываться несколько иным образом.</p>
			<p>Так вот, чтобы обработать параметры требуется: </p>
<pre class="prettyprint">
echo off
cls
echo start backup
mkdir %1
copy *.* %1
echo end backup
</pre>			
			<p>То есть после запуска будет создана папка для бекапа, а название этой папки будет "papka" и в неё будет скопированы все файлы. </p>
			<p>На этом с переменными более или менее все, если вдруг что то не понятно или не получается смотрите материал, который указан в ссылках или спрашивайте преподавателя.</p>

			<p><b> Циклы </b></p>
			<p>Начнём с for, как работает for вы уже в курсе, если вдруг забыли, то лучше где нибудь посмотрите. Напоминаю, что есть справка - for /? , там даже описано подробнее чем я вам напишу.  Синтаксис у него:</p>
<pre class="prettyprint">
for /L %%переменная in (начало, шаг, конец) do (оператор)
</pre>
			<p>Ключ /L говорит о том, что происходит перебор данных, далее следует имя переменной, в которую эти данные будут записываться. В круглых скобках нужно через запятую указать три параметра:
			<ol>
			<li>начало – начальное значение</li>
			<li>шаг – тут мы указывает, насколько нужно увеличивать или уменьшать начальное значение при каждой итерации. То есть, если параметр содержит отрицательное число, то будет происходить уменьшение, иначе – увеличение параметра “начало”.</li>
			<li>конец – тут нужно указать конечное значение, именно оно и будет определять, завершать цикл или нет. То есть, при каждой итерации происходит сравнивание начального и конечного параметра.</li>
			</ol>
			</p>
			<p>Например: </p>
<pre class="prettyprint">
@echo off
for /L %%B in (0,1,5) do echo %%B
echo.
for /L %%B in (5,-1,0) do echo %%B
</pre>
			<p>В данном сценарии используются два цикла for командной строки, первый задает диапазон цифр от 0 до 5 с шагом 1, второй – диапазон цифр от 5 до 0 с шагом -1. То есть, прямой и обратный порядок. Функция ЭХО будет в виде списка выводить содержимое переменной B. Команда “echo.” вставляем между списками пустую строку.</p>
			<p>Так же можно работать с файлами</p>
			for %переменная in (набор_файлов) do (оператор)
<pre class="prettyprint">
for %переменная in (набор_файлов) do (оператор)
</pre>
			<p>Например выведем все файлы из какого-либо каталога с определенным расширением</p>
<pre class="prettyprint">
@echo off
for %%В in (d:\work\*.txt) do (echo %%В)
</pre>
			<p>По поводу for более-менее рассказал, остальная информация либо в ссылках, либо по ключу - команда /? </p>

			<p><b> Метки </b></p>
			<p>Тут не зазорно использовать метки, если не помните, желательно представлять, что это такое, если вдруг не представляете, то лучше ознакомиться самим. </p>
			<p>Синтаксис:</p>
<pre class="prettyprint">
:метка
goto метка
</pre>
			<p>Как это все работает на примере бесконечного цикла: </p>
<pre class="prettyprint">
@echo off
set sum=1
 
:SUB1
set/A sum+=1
echo %sum%
goto SUB1
</pre>
		<p>Тут происходит создание переменной sum со значением 1. После метки SUB1 происходит добавление к sum числа 1, вывод результата и переход к этой же метке. Цикл будет выполняться бесконечно, что бы прекратить выполнение сценария нажмите комбинацию клавиш Ctrl+C.</p>

		<p>Так же не забывайте, что существует справка - goto /?</p>

		<b><p> Условия </p></b>
		<p>Уж как работает данный оператор вы точно должны знать. Синтаксис его довольно прост:</p>
<pre class="prettyprint">
if условие (оператор1) [else (оператор2)]
</pre>
		<p>Использование круглых скобок не является обязательным, но если вам нужно после проверки условия выполнить сразу несколько операторов cmd if, то круглые скобки необходимы.</p>
<pre class="prettyprint">
if "1"=="1" (echo odin) else (echo dva)
</pre>
		<p>If так же может вкладываться в себя, например: (<s>А в ранних версиях не умел</s>)</p>
<pre class="prettyprint">
@echo off
if "%1"=="1" (@if "%2"=="2" (hostname & ver) else (ver)) else (hostname & ver & netstat -a)
</pre>	

		<p>В данном примере, первый оператор командной строки if проверяет, равен ли первый аргумент 1, если да, то идет выполнение второго условно оператора и проверка на значение другого аргумента и далее идёт уже выполнение команд.

		Обратите внимание!!! Все переменные определяются как строки. При проверке условия имена переменных и значений заключались в двойные кавычки, это позволяет избежать ошибок, так как параметры или аргументы могут содержать пробелы, или же у переменной может и вовсе отсутствовать значение.</p>
		<p>НЕ ЗАБЫВАЙТЕ, ЧТО ЕСТЬ СПРАВКА - if /? . Там куда больше информации, чем тут. </p>

		<p>Так же у оператора сравнения(==) есть аналоги: </p>
		<ol>
			<li>equ «Равно». Дает True, если значения равны</li>
			<li>neq «Не равно». Дает True, если значения не равны</li>
			<li>lss «Меньше». Дает True, если зпачение1 меньше, чем значение2</li>
			<li>lcq «Меньше или равно». Дает True, если значепие1 равно или меньше, чемзначение2
			</li>
			<li>gtr «Больше». Дает True, если значение1 больше, чем значение2</li>
			<li>geq «Больше или равно». Дает True, если значепие1 равно или больше, чем значение2
			</li>
		</ol>

			<p>Общая информация у вас есть, теперь осталась практика, практика, и ещё раз практика :)</p>


			<h3 id="task">Задание</h3>
			<p>За заданиями подходить к преподавателю.</p>

			<h3 id="qwe">Контрольные вопросы</h3>
			<ol>
				<li>Что такое bat-файлы?</li>
				<li>Что такое скрипты?</li>
				<li>Что такое абсолютный и относительный путь? </li>
				<li>Что такое переменные окружения? Для чего они используются?</li>
				<li>Для чего применяются bat-файлы и в каких ОС?</li
			</ol>





			<h3 id="src">Ссылки</h3>
			<ol>
				<li><a href="https://habrahabr.ru/post/92590/">Хабр, отличия программы от скрипта</a></li>
				<li> <a href="https://safezone.cc/threads/peremennye-v-cmd-komanda-set-i-arifmetika.22660/">Материал по синтаксису bat-файлов</a> </li>
				<li><a href="http://scriptcoding.ru/2013/08/17/peremennyje-cmd/">Переменные в bat-файлах</a></li>
				<li><a href="http://scriptcoding.ru/2013/08/17/operator-if-cmd/">Условный оператор в bat-файлах</a></li>
				<li><a href="http://scriptcoding.ru/2013/08/19/cykl-v-komandnoy-stroke/">Циклы в bat-файлах</a></li>
				<li><a href="http://scriptcoding.ru/2013/08/20/funkcii-komandno-stroki/
">Процедуры и функции в bat-фалах</a></li>
				<li> <a href="https://ru.wikipedia.org/wiki/Оболочка_операционной_системы
">Вики - оболочка ОС</a> </li>
				<li><a href="https://ru.wikipedia.org/wiki/Пакетный_файл
">Вики - Пакетные файлы</a></li>
				<li><a href="http://lurkmore.to/BAT">Лурк, bat-файлы. Да, да, да это лурк.</a></li>
				<li><a href="https://geektimes.ru/post/60604/">Хабр, про bat-файлы, их синтаксис</a></li>
			</ol>



            </div>
        </div>
    </section>
</div>
<script src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/prettify/prettify.js"></script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=css&skin=sunburst"></script>
<script src="js/layout.js"></script>
</body>
</html>